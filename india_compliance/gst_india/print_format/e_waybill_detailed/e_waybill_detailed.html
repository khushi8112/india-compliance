<style>
    {% include "india_compliance/gst_india/print_format/e_waybill_detailed/e_waybill_detailed.css" %}
</style>

{% set data = _dict(json.loads(doc.data)) %}
{%- set irn = frappe.db.get_value("Sales Invoice", {"ewaybill": data.ewbNo}, "irn") -%} 
{%- set irn = data.irn -%} {#temp#}

{% if data.supplyType == "O" %}
    {% set generated_by = data.fromTrdName %}
{% else %}
    {% set generated_by = data.toTrdName %}
{% endif %}

<html lang="en">
    <body>
        <div class="page-layout">
            <table class="table no-border">
                <tbody>
                    <tr>
                        <td class="text-left align-middle">
                            <h1 class="title">e-Waybill</h1>
                        </td>
                        <td class="text-right align-middle">
                            <img
                                src="https://upload.wikimedia.org/wikipedia/commons/d/d0/QR_code_for_mobile_English_Wikipedia.svg"
                                class="qr-code"
                            />
                        </td>
                    </tr>
                </tbody>
            </table> 

            <div class="table-heading" >E-Way Bill Details</div>
            <table class="table">
                <tbody class="table-element">
                    <tr>
                        <td>
                            <span class="attribute">eWay Bill No: </span>
                            <span class="attribute-value">2818 6444 2513</span>
                        </td>
                        <td>
                            <span class="attribute">Generated Date: </span>
                            <span class="attribute-value">26/11/2024 12:00 PM</span>
                        </td>
                        <td>
                            <span class="attribute">Generated By: </span>
                            <span class="attribute-value">27AAG CP577 4K1ZT</span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span class="attribute">Mode: </span>
                            <span class="attribute-value">Road</span>
                        </td>
                        <td>
                            <span class="attribute">Approx Distance: </span>
                            <span class="attribute-value">20km</span>
                        </td>
                        <td>
                            <span class="attribute">Valid Upto: </span>
                            <span class="attribute-value">27/11/2024</span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span class="attribute">Type: </span>
                            <span class="attribute-value">Outward - Export</span>
                        </td>
                        <td>
                            <span class="attribute">Document Details: </span>
                            <span class="attribute-value">{{data.DocDtls.Typ}} - {{data.DocDtls.No}} - {{data.DocDtls.Dt}}</span>
                        </td>
                        <td>
                            <span class="attribute">Transaction type: </span>
                            <span class="attribute-value">Regular</span>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <span class="attribute">Irn: </span>
                            <span class="attribute-value">{{data.Irn}}</span>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <div class="table-heading" >Address Details</div>
            <table class="table">
                <tbody class="table-element">
                    <tr>
                        <td style="width: 50%;">
                            {% set from_state = get_state(data.ShipDtls.Stcd) %}
                            
                            <div class="bold mb-2">From</div>
                            <div>
                                <div>
                                    <div>GSTIN: {{ data.ShipDtls.Gstin }}</div>
                                    <div>{{data.ShipDtls.LglNm}}</div>
                                    <div>{{ from_state }}</div> {# get_state_by_state_code #}
                                </div>
                                <div>
                                    :: Dispatch From ::
                                    <div>{{data.ShipDtls.Addr1}}</div>
                                    <div>{{data.ShipDtls.Addr2}}</div>
                                    <div>{{data.ShipDtls.Loc}}, {{from_state}}-{{ data.ShipDtls.Pin }}</div>
                                </div>
                            </div>
                        </td>
                        <td style="width: 50%;">
                            {% set to_state = get_state(data.SellerDtls.Stcd) %}
                            <div class="bold mb-2">To</div>
                            <div>
                                <div>
                                    <div>GSTIN: {{ data.SellerDtls.Gstin }}</div>
                                    <div>{{data.SellerDtls.LglNm}}</div>
                                    <div>{{ to_state }}</div> {# get_state_by_state_code #}
                                </div>
                                <div>
                                    :: Ship To ::
                                    <div>{{data.SellerDtls.Addr1}}</div>
                                    <div>{{data.SellerDtls.Addr2}}</div>
                                    <div>{{data.SellerDtls.Loc}}, {{to_state}}-{{ data.SellerDtls.Pin }}</div>
                                </div>
                            </div>
                        </td>
                    </tr>   
                                    
                </tbody>
            </table>

            <div class="table-heading" >Goods Details</div>

            <table class="table">
                <tbody class="table-element">
                    <tr class="bold">
                        <td>
                           HSN Code 
                        </td>
                        <td>
                           Product Name & Desc.
                        </td>
                        <td>
                           Quantity
                        </td>
                        <td>
                           Taxable Amount Rs.
                        </td>
                        <td>
                           Tax Rate (C + S + I + Cess + Cess Non. Advol)
                        </td>
                    </tr>   
                    {% for item in data.ItemList %}
                        <tr>
                            <td>
                                {{item.HsnCd}}
                            </td>
                            <td>
                                {{item.PrdDesc}}
                            </td>
                            <td>
                                {{item.Qty}} {{item.Unit}}
                            </td>
                            <td>
                                temp value {# taxable amt. #}
                            </td>
                            <td>
                                temp value {# tax rate #}
                            </td>
                        </tr>        
                
                    {% endfor %}       
                </tbody>
            </table>

            <table class="table">
                <tbody class="table-element">
                    <tr class="bold">
                        <td>
                            Tot. Taxable Amt.
                        </td>
                        <td>
                            CGST Amt.
                        </td>
                        <td>
                           SGST Amt.
                        </td>
                        <td>
                           IGST Amt.
                        </td>
                        <td>
                           CESS Amt.
                        </td>
                        <td>
                           CESS Non. Advol Amt.
                        </td>
                        <td>
                           Other Amt.
                        </td>
                        <td>
                           Total Inv. Amt.
                        </td>
                    </tr>   
                    <tr>
                        
                    </tr>        
     
                </tbody>
            </table>

            <div class="table-heading" >Transportation Details</div>

            <table class="table">
                <tbody class="table-element">
                    <tr>
                        <td>
                            <span class="attribute">Transporter ID & Name: </span>
                            <span class="attribute-value">{{data.EwbDtls.TransName}}</span>
                        </td>
                        <td>
                            <span class="attribute">Transporter Doc. No & Date:</span>
                            <span class="attribute-value"> where?? </span>
                        </td>
                    </tr>  
                </tbody>
            </table>

            <div class="table-heading" >Vehicle Details</div>

            <table class="table">
                <tbody class="table-element">
                    <tr class="bold">
                        <td>
                            Mode
                        </td>
                        <td>
                            Vehicle / Trans Doc. No. & Dt.
                        </td>
                        <td>
                            From
                        </td>
                        <td>
                            Entered Date
                        </td>
                        <td>
                            Entered By
                        </td>
                        <td>
                            CEWB No. (If any)
                        </td>
                        <td>
                            Multi Veh. Info (If any)
                        </td>
                    </tr>  
                    <tr>
                        <td>
                            where??
                        </td>
                        <td>
                            {{data.EwbDtls.VehNo}} maybe?
                        </td>
                        <td>
                            {{from_state}} maybe?
                        </td>
                        <td>
                            where??
                        </td>
                        <td>
                            where??
                        </td>
                        <td>
                            where??
                        </td>
                        <td>
                            where??
                        </td>

                    </tr>
                </tbody>
            </table>

            <table class="table no-border text-center">
                <tbody>
                    <tr>
                        <td>
                            <div class="middle">
                                <img class="barcode" src="data:image/png;base64,{{ get_ewaybill_barcode(data.ewbNo) }}">
                                <div class="section-separator"></div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>

           


            


            
            {#<div class="borderless" style="width: 100%;">
                <span class="text-left float-left">
                    <h1 class="title">e-Waybill</h1>
                </span>
                <span class="text-right float-right">
                    <img
                        src="https://upload.wikimedia.org/wikipedia/commons/d/d0/QR_code_for_mobile_English_Wikipedia.svg"
                        class="qr-code"
                    />
                </span>
            </div> 
            #}

        </div>
    </body>
</html>
